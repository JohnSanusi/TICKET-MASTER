module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},26046,(e,t,r)=>{t.exports=e.x("mongoose",()=>require("mongoose"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},57431,e=>{"use strict";var t=e.i(26046);let r=process.env.DATABASE_URL;if(!r)throw Error("DATABASE_URL is not defined");let a=e.g.mongoose;async function i(){if(a.conn)return a.conn;a.promise||(a.promise=t.default.connect(r,{bufferCommands:!1,serverApi:{version:"1",strict:!0,deprecationErrors:!0}}).then(e=>e));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}a||(a=e.g.mongoose={conn:null,promise:null});let n=new t.default.Schema({artistName:String,title:{type:String,required:!0},description:{type:String,required:!0},location:{type:String,required:!0},date:{type:String,required:!0},time:{type:String,required:!0},image:String,seatMap:{type:String,default:"[]"},maxTickets:{type:Number,default:50},hasTimer:{type:Boolean,default:!1},eventDate:String,eventTime:String},{timestamps:!0}),s=new t.default.Schema({eventId:{type:String,required:!0},seatRow:{type:String,required:!0},seatNum:{type:Number,required:!0},email:{type:String,required:!0},name:{type:String,required:!0},section:String,ticketType:String,level:String,ticketId:{type:String,required:!0,unique:!0}},{timestamps:!0}),d=t.default.models.Event||t.default.model("Event",n),o=t.default.models.ClaimedSeat||t.default.model("ClaimedSeat",s),l=e=>{if(!e)return null;let t=e.toObject?e.toObject():e;return t._id&&(t.id=t._id.toString(),delete t._id,delete t.__v),JSON.parse(JSON.stringify(t))};e.s(["db",0,{event:{create:async e=>(await i(),l(await d.create(e))),findUnique:async e=>(await i(),l(await d.findById(e.id))),findMany:async e=>(await i(),(await d.find().sort({createdAt:-1})).map(l)),update:async e=>(await i(),l(await d.findByIdAndUpdate(e.where.id,e.data,{new:!0}))),delete:async e=>(await i(),l(await d.findByIdAndDelete(e.id))),findUniqueWithClaims:async e=>{await i();let t=await d.findById(e.id);if(!t)return null;let r=await o.find({eventId:e.id}),a=l(t);return a.claimedSeats=r.map(l),a},findManyWithClaims:async()=>{await i();let e=await d.find().sort({createdAt:-1});return await Promise.all(e.map(async e=>{let t=await o.find({eventId:e._id.toString()}),r=l(e);return r.claimedSeats=t.map(l),r}))}},claimedSeat:{create:async e=>(await i(),l(await o.create(e))),findFirst:async e=>(await i(),l(await o.findOne(e)))}}],57431)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2fbbd918._.js.map