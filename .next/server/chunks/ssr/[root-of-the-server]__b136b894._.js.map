{"version":3,"sources":["../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../lib/db.ts","../../../../lib/models.ts","../../../../lib/db-adapter.ts","../../../../lib/constants.ts","../../../../app/actions/events.ts","../../../../.next-internal/server/app/help/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","import mongoose from \"mongoose\"\n\nconst MONGODB_URI = process.env.DATABASE_URL\n\nif (!MONGODB_URI) {\n  throw new Error(\"DATABASE_URL is not defined\")\n}\n\nlet cached = (global as any).mongoose\n\nif (!cached) {\n  cached = (global as any).mongoose = { conn: null, promise: null }\n}\n\nasync function connectDB() {\n  if (cached.conn) {\n    return cached.conn\n  }\n\n  if (!cached.promise) {\n    const opts: mongoose.ConnectOptions = {\n      bufferCommands: false,\n      serverApi: {\n        version: \"1\" as any,\n        strict: true,\n        deprecationErrors: true,\n      },\n    }\n\n    cached.promise = mongoose.connect(MONGODB_URI!, opts).then((mongoose) => {\n      return mongoose\n    })\n  }\n\n  try {\n    cached.conn = await cached.promise\n  } catch (e) {\n    cached.promise = null\n    throw e\n  }\n\n  return cached.conn\n}\n\nexport default connectDB\n","import mongoose from \"mongoose\"\n\nconst eventSchema = new mongoose.Schema({\n  artistName: String,\n  title: { type: String, required: true },\n  description: { type: String, required: true },\n  location: { type: String, required: true },\n  date: { type: String, required: true },\n  time: { type: String, required: true },\n  image: String,\n  seatMap: { type: String, default: \"[]\" },\n  maxTickets: { type: Number, default: 50 },\n  hasTimer: { type: Boolean, default: false },\n  eventDate: String,\n  eventTime: String,\n}, { timestamps: true })\n\nconst claimedSeatSchema = new mongoose.Schema({\n  eventId: { type: String, required: true },\n  seatRow: { type: String, required: true },\n  seatNum: { type: Number, required: true },\n  email: { type: String, required: true },\n  name: { type: String, required: true },\n  section: String,\n  ticketType: String,\n  level: String,\n  ticketId: { type: String, required: true, unique: true },\n}, { timestamps: true })\n\nexport const Event = mongoose.models.Event || mongoose.model(\"Event\", eventSchema)\nexport const ClaimedSeat = mongoose.models.ClaimedSeat || mongoose.model(\"ClaimedSeat\", claimedSeatSchema)\n","import connectDB from \"./db\"\nimport { Event, ClaimedSeat } from \"./models\"\n\n// Helper to convert mongoose doc to object with id\nconst toObject = (doc: any) => {\n  if (!doc) return null\n  const obj = doc.toObject ? doc.toObject() : doc\n  if (obj._id) {\n    obj.id = obj._id.toString()\n    delete obj._id\n    delete obj.__v\n  }\n  return JSON.parse(JSON.stringify(obj))\n}\n\nexport const db = {\n  event: {\n    create: async (data: any) => {\n      await connectDB()\n      const event = await Event.create(data)\n      return toObject(event)\n    },\n    findUnique: async (where: { id: string }) => {\n      await connectDB()\n      const event = await Event.findById(where.id)\n      return toObject(event)\n    },\n    findMany: async (options?: any) => {\n      await connectDB()\n      const events = await Event.find().sort({ createdAt: -1 })\n      return events.map(toObject)\n    },\n    update: async (params: { where: { id: string }; data: any }) => {\n      await connectDB()\n      const event = await Event.findByIdAndUpdate(params.where.id, params.data, { new: true })\n      return toObject(event)\n    },\n    delete: async (where: { id: string }) => {\n      await connectDB()\n      const event = await Event.findByIdAndDelete(where.id)\n      return toObject(event)\n    },\n    findUniqueWithClaims: async (where: { id: string }) => {\n      await connectDB()\n      const event = await Event.findById(where.id)\n      if (!event) return null\n      \n      const claimedSeats = await ClaimedSeat.find({ eventId: where.id })\n      const eventObj = toObject(event)\n      eventObj.claimedSeats = claimedSeats.map(toObject)\n      return eventObj\n    },\n    findManyWithClaims: async () => {\n      await connectDB()\n      const events = await Event.find().sort({ createdAt: -1 })\n      const eventsWithClaims = await Promise.all(\n        events.map(async (event) => {\n          const claimedSeats = await ClaimedSeat.find({ eventId: event._id.toString() })\n          const eventObj = toObject(event)\n          eventObj.claimedSeats = claimedSeats.map(toObject)\n          return eventObj\n        })\n      )\n      return eventsWithClaims\n    },\n  },\n  claimedSeat: {\n    create: async (data: any) => {\n      await connectDB()\n      const claim = await ClaimedSeat.create(data)\n      return toObject(claim)\n    },\n    findFirst: async (where: any) => {\n      await connectDB()\n      const claim = await ClaimedSeat.findOne(where)\n      return toObject(claim)\n    },\n  },\n}\n","export const ROWS = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"]\n\nexport function generateDefaultSeatMap(maxTickets: number = 50) {\n  const seats = []\n  const seatsPerRow = Math.ceil(maxTickets / ROWS.length)\n  let remainingSeats = maxTickets\n  \n  for (const row of ROWS) {\n    if (remainingSeats <= 0) break\n    \n    const seatsInThisRow = Math.min(seatsPerRow, remainingSeats)\n    for (let num = 1; num <= seatsInThisRow; num++) {\n      seats.push({ row, num, available: true })\n    }\n    remainingSeats -= seatsInThisRow\n  }\n  \n  return seats\n}\n","\"use server\"\n\nimport { db } from \"@/lib/db-adapter\"\nimport { generateDefaultSeatMap } from \"@/lib/constants\"\n\nexport async function createEvent(data: {\n  artistName?: string\n  title: string\n  description: string\n  location: string\n  date: string\n  time: string\n  image?: string\n  maxTickets?: number\n  hasTimer?: boolean\n  eventDate?: string\n  eventTime?: string\n}) {\n  try {\n    console.log('[Server Action] Creating event with data:', data)\n    const seatMap = generateDefaultSeatMap(data.maxTickets || 50)\n\n    const event = await db.event.create({\n      artistName: data.artistName || null,\n      title: data.title,\n      description: data.description,\n      location: data.location,\n      date: data.date,\n      time: data.time,\n      image: data.image || null,\n      seatMap: JSON.stringify(seatMap),\n      maxTickets: data.maxTickets || 50,\n      hasTimer: data.hasTimer || false,\n      eventDate: data.eventDate || null,\n      eventTime: data.eventTime || null,\n    })\n\n    console.log('[Server Action] Event created successfully:', event)\n    return event\n  } catch (error) {\n    console.error('[Server Action] Error creating event:', error)\n    throw error\n  }\n}\n\nexport async function addTimerToEvent(eventId: string, eventDate: string, eventTime: string) {\n  const event = await db.event.update({\n    where: { id: eventId },\n    data: {\n      eventDate,\n      eventTime,\n      hasTimer: true,\n    },\n  })\n\n  return event\n}\n\nexport async function claimSeat(eventId: string, seatRow: string, seatNum: number, email: string, name: string) {\n  const ticketId = `TKT-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\n\n  const existingClaim = await db.claimedSeat.findFirst({\n    eventId,\n    seatRow,\n    seatNum,\n  })\n\n  if (existingClaim) {\n    throw new Error(\"Seat already claimed\")\n  }\n\n  const claim = await db.claimedSeat.create({\n    eventId,\n    seatRow,\n    seatNum,\n    email,\n    name,\n    ticketId,\n  })\n\n  return claim\n}\n\nexport async function getEventById(eventId: string) {\n  const event = await db.event.findUniqueWithClaims({\n    id: eventId,\n  })\n\n  return event\n}\n\nexport async function getAllEvents() {\n  try {\n    const events = await db.event.findManyWithClaims()\n    return events\n  } catch (error) {\n    console.error(\"Failed to fetch events:\", error)\n    return []\n  }\n}\n\nexport async function deleteEvent(eventId: string) {\n  try {\n    await db.event.delete({ id: eventId })\n    return { success: true }\n  } catch (error) {\n    console.error(\"Failed to delete event:\", error)\n    return { success: false, error: \"Failed to delete event\" }\n  }\n}\n","export {getAllEvents as '00cca0bed949ff7093ff3c5fde4d3d82cdbd5c3f65'} from 'ACTIONS_MODULE0'\nexport {createEvent as '401b73206a0ddefb89029d23d1c0932daaa79ce402'} from 'ACTIONS_MODULE0'\nexport {getEventById as '40bda02e207a1fccc9b21becabb299ff49ed9f3710'} from 'ACTIONS_MODULE0'\nexport {deleteEvent as '40e52b96d98da03514f4533da52bd4a94d0912228d'} from 'ACTIONS_MODULE0'\nexport {addTimerToEvent as '70b65ae6490ce549e9724b966089305ab0c0c18c8a'} from 'ACTIONS_MODULE0'\nexport {claimSeat as '7c9c2929a3363c902ba8f99630ed9f11bc08ef4060'} from 'ACTIONS_MODULE0'\nexport {createEvent as '401b73206a0ddefb89029d23d1c0932daaa79ce402'} from 'ACTIONS_MODULE0'\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[0,1]}